<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="res_partner_view_form" model="ir.ui.view">
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form" />
        <field name="arch" type="xml">
            <div name="button_box" position="inside">
                <button name="button_open_partner_stops" type="object"
                        class="oe_stat_button" icon="fa-map-marker"
                        attrs="{'invisible': [('educational_category', '!=', 'student')]}">
                    <field name="stop_count" widget="statinfo"
                           string="Stops" />
                </button>
            </div>
            <field name="vat" position="after">
                <field name="bus_passenger" />
            </field>
        </field>
    </record>

    <record id="res_partner_view_search" model="ir.ui.view">
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_res_partner_filter" />
        <field name="arch" type="xml">
            <filter name="inactive" position="after">
                <separator />
                <filter string="Uses Bus" name="bus_passenger" domain="[('bus_passenger','=',True)]"/>
                <filter string="No Uses Bus" name="no_bus_passenger" domain="[('bus_passenger','!=',True)]"/>
            </filter>
        </field>
    </record>

    <record id="action_res_partner" model="ir.actions.act_window">
        <field name="name">Students / Passengers</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">res.partner</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree</field>
        <field name="domain">[("educational_category","in",["student"])]</field>
    </record>

    <menuitem id="fleet_partner_menuitem"
              parent="fleet_route.fleet_route_base_menuitem"
              action="action_res_partner"
              sequence="105" />
</odoo>
